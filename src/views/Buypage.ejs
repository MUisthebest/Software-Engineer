<section class="Buy">
    <article>
        <nav>
            <label for="cost"></label>
            <select name="cost" id="cars">
              <option value="volvo">Volvo</option>
              <option value="saab">Saab</option>
              <option value="opel">Opel</option>
              <option value="audi">Audi</option>
            </select>
            <div class="search_box">
                <div class="search-container">
                    <input type="text" id = "input-box" placeholder="Search...">
                    <button onclick="resultSearch()"><i class="fas fa-search"></i></button>
                </div>
                <div class="result_box"></div>
            </div>
            <div class="right_bx">
                <i class="far fa-moon" id="moon"></i>
                <i class="fas fa-sun" id="sun"></i>
                <i class="fas fa-wifi" id="wifi"></i>
                <i class="fas fa-shopping-cart" id="cart"></i>
                <div id="cart-dropdown" class="dropdown-content hide5">
                    <h3>Your Cart</h3>
                    <ul id="cart-items">
                    </ul>
                    <button id="checkout-button">Checkout</button>
                </div>
                <button id="active_battery"><i class="fas fa-battery-three-quarters" id="battery_icon"></i><span id="battery_level">84%</span></button>
            </div>
        </nav>
        <div class="main">
            <div class="game1">
                <div class="scroll_item_bt">
                   <i class="fas fa-caret-left" id="game_bx_1_left_bt"></i>
                   <i class="fas fa-caret-right" id="game_bx_1_right_bt"></i>
                </div>
                <h3><i class="fab fa-bandcamp"></i>Recommend For You</h3>
                <div class="gameBx" id="game_bx_1">
                    <% for (let i = 0; i < products.length; i++){ %>
                        <div class="product">
                            <a href="/products/<%=products[i].id%>" id="<%=products[i].id%>">
                                <img src="data:image/<%=products[i].image.contentType%>;base64,<%=products[i].image.data.toString('base64')%>">
                                <div class="content">
                                    <div class="left">
                                        <h5><%=products[i].name%></h5> 
                                        <button class="buy_now" data-product-id="<%= i %>" productAll = "<%= products %>"><p class="p1">Buy Now</p><p class="p2"><%=products[i].price%> $</p></button>
                                    </div>
                                </div>
                            </a>
                        </div>
                    <% } %>  
                </div>
            </div>
            <div class="game2">
                <h3><i class="fas fa-bomb"></i>List Product</h3>
                <div class="gameBx" id="game_bx_2">       
                    <% for (let i = 0; i < products.length; i++){ %>
                        <div class="product">
                            <a href="/products/<%=products[i].id%>" id="product <%=products[i].id%>">
                                <img src="data:image/<%=products[i].image.contentType%>;base64,<%=products[i].image.data.toString('base64')%>">
                                <div class="content">
                                    <div class="left">
                                        <h5><%=products[i].name%></h5> 
                                        <button class="buy_now" data-product-id="<%= i %>" productAll = "<%= products %>"><p class="p1">Buy Now</p><p class="p2"><%=products[i].price%> $</p></button>
                                    </div>
                                </div>
                            </a>
                        </div>
                    <% } %>              
                </div>
            </div>
            <div class="game3 disable">
                <h3><i class="fas fa-bomb"></i>List Product</h3>
                <div class="gameBx" id="game_bx_2">       
                    <% for (let i = 0; i < products.length; i++){ %>
                        <div class="product">
                            <a href="/products/<%=products[i].id%>" id="product <%=products[i].id%>">
                                <img src="data:image/<%=products[i].image.contentType%>;base64,<%=products[i].image.data.toString('base64')%>">
                                <div class="content">
                                    <div class="left">
                                        <h5><%=products[i].name%></h5> 
                                        <button class="buy_now" data-product-id="<%= i %>" productAll = "<%= products %>"></button><p class="p1">Buy Now</p><p class="p2"><%=products[i].price%> $</p></button>
                                    </div>
                                </div>
                            </a>
                        </div>
                    <% } %>              
                </div>
            </div>            
        </div>
    </article>
</section>
<!-- <script src ="/js/importListUser.js"></script> -->
<script src ="/js/handleScrollBar.js"></script>
<script src ="/js/handleShopping.js"></script>
<script src="/js/changeIndicate.js"></script>
<script>
    function resultSearch(){
        var x = document.querySelector(".game1");
        AddClass(x, "disable");
        var y = document.querySelector(".game2");
        AddClass(y, "disable"); 
        var z = document.querySelector(".game3");
        RemoveClass(z, "disable");                
    }

    function AddClass(element, name) {
        var i, arr1, arr2;
        arr1 = element.className.split(" ");
        arr2 = name.split(" ");
        for (i = 0; i < arr2.length; i++) {
          if (arr1.indexOf(arr2[i]) == -1) {element.className += " " + arr2[i];}
        }
      }
      
      function RemoveClass(element, name) {
        var i, arr1, arr2;
        arr1 = element.className.split(" ");
        arr2 = name.split(" ");
        for (i = 0; i < arr2.length; i++) {
          while (arr1.indexOf(arr2[i]) > -1) {
            arr1.splice(arr1.indexOf(arr2[i]), 1);     
          }
        }
        element.className = arr1.join(" ");
      }
</script>     

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const buyNowButtons = document.querySelectorAll('.buy_now');
        const cartIcon = document.getElementById('cart');
        const cartDropdown = document.getElementById('cart-dropdown');
        const cartItems = document.getElementById('cart-items');
        const cartCount = document.getElementById('cart-count');
    
        let cart = [];
    
        buyNowButtons.forEach(button => {
            button.addEventListener('click', function(event) {
                event.preventDefault();
                const productId = this.getAttribute('data-product-id');
                const productName = this.parentElement.querySelector('h5').textContent;
                const productPrice = this.querySelector('.p2').textContent;
                const productImage = this.closest('.product').querySelector('img').src;
                addToCart(productId, productName, productPrice, productImage);
            });
        });
    
        cartIcon.addEventListener('click', function() {
            cartDropdown.classList.toggle('hide5');
        });
    
        function addToCart(productId, productName, productPrice, productImage) {
            const existingProduct = cart.find(item => item.id === productId);
            if (existingProduct) {
                existingProduct.quantity += 1;
            } else {
                cart.push({ id: productId, name: productName, price: productPrice, image: productImage, quantity: 1 });
            }
            updateCartDisplay()
        }
        function updateCartDisplay() {
            cartItems.innerHTML = '';
            cart.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <span>${item.name} (${item.quantity}) - ${item.price}</span>
                `;
                cartItems.appendChild(li);
            });
        }    
    });
    
    
</script>




